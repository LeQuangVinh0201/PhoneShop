<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="ISO-8859-1">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<link rel="stylesheet" href="/bootstrap.css">
<script src="/bootstrap.js"></script>
<link rel="stylesheet" type="text/css" href="/CustomeCss/MainPage.css">
<link rel="stylesheet" type="text/css" href="/CustomeCss/Cart.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<title>Insert title here</title>
<style>
html,body {
  scroll-behavior: smooth;
}
</style>
</head>
<body>
<div style="background-color: #f4f4f4;">
  <div id="header" class="container-fluid text-white">
    <div class="row" style="padding: 0;">
        <div class="col-2" style="padding:5px">
          <img src="/LogoImage/logo.png"  width="100" height="70" style="cursor: pointer; ">
        </div>
        <div class="col-6 d-flex justify-content-center pl-4">
          <input type="text" id="nameSearch" placeholder=" Please enter product's name to search" style="width: 80%; height: 50%;margin-top: 20px; margin-left:90px; border-radius: 10px;">
          <button type="button" id="searchByNameBtn" class="btn btn-danger" style="width:50px ; height: 50%;margin-top: 20px;"><i class="fa fa-search" aria-hidden="true"></i></button>
        </div>
        <div class="col-4 d-flex justify-content-center">
          <div class="row container ml-4">
            <div class="col-4 text-center"  id="cart" style="position: relative;">
              <i class="fa fa-shopping-cart pt-3" aria-hidden="true" style="font-size: 18px;"></i><br>
              <span>Your Cart</span>
              <span class="fs-cartic countTotalCart" th:if="${orderNumber != null}">[[${orderNumber}]] </span>
            </div>
            <div class="col-5 text-center"  id="personAccount">
              <i class="fa fa-user pt-3" aria-hidden="true" style="font-size: 18px;"></i><br>
              <span th:if="${username != null}" >Hi [[${username}]] !</span>
            </div>
            <div class="col-3 text-center"  id="logoutAccount" th:if="${username != null}">
              <i class="fa fa-sign-out pt-3" aria-hidden="true" style="font-size: 18px;"></i><br>
              <span th:if="${username != null}">Log out</span>
            </div>
          </div>
        </div>
    </div>
  </div>
  
  <div class="container-fluid mt-4 d-flex justify-content-center">
    <nav class="navbar navbar-expand-lg navbar-dark " style="background-color: #00483d; border-radius: 10px; width: 80%;">
      <div class="container-fluid  d-flex justify-content-around" >
        <ul class="navbar-nav">
          <li class="nav-item dropdown" style="padding-left: 50px;"> 
            <a class="nav-link dropdown-toggle text-white" href="#" data-bs-toggle="dropdown">Apple </a> 
            <ul class="dropdown-menu fade-up">
                <li><a class="dropdown-item" href="/user/searchBySeries/iphone14" > iPhone 14 Series</a></li>
                <li><a class="dropdown-item" href="#"> iPhone 13 Series </a></li>
                <li><a class="dropdown-item" href="#"> iPhone 12 Series </a></li>
            </ul>
          </li>
          <li class="nav-item dropdown" style="padding-left: 50px;">
            <a class="nav-link dropdown-toggle text-white" href="#" data-bs-toggle="dropdown">  Samsung  </a>
              <ul class="dropdown-menu fade-up">
                  <li><a class="dropdown-item" href="#"> Galaxy Z Series</a></li>
                  <li><a class="dropdown-item" href="#"> Galaxy S Series </a></li>
                  <li><a class="dropdown-item" href="#"> Galaxy A Series </a></li>
              </ul>
          </li>
          <li class="nav-item dropdown" style="padding-left: 50px;">
            <a class="nav-link dropdown-toggle text-white" href="#" data-bs-toggle="dropdown">  Xioami  </a>
              <ul class="dropdown-menu fade-up">
                <li><a class="dropdown-item" href="#"> Xiaomi Redmi</a></li>
                <li><a class="dropdown-item" href="#"> Xiaomi Redmi Note </a></li>
              </ul>
          </li>
          <li class="nav-item dropdown" style="padding-left: 50px;">
            <a class="nav-link dropdown-toggle text-white" href="#" data-bs-toggle="dropdown">  Oppo  </a>
              <ul class="dropdown-menu fade-up">
                <li><a class="dropdown-item" href="#"> OPPO Find X Series</a></li>
                <li><a class="dropdown-item" href="#"> OPPO Reno Series </a></li>
                <li><a class="dropdown-item" href="#"> OPPO A Series </a></li>
              </ul>
          </li>
          <li class="nav-item dropdown" style="padding-left: 50px;">
            <a class="nav-link dropdown-toggle text-white" href="#" data-bs-toggle="dropdown">  Vivo  </a>
              <ul class="dropdown-menu fade-up">
                <li><a class="dropdown-item" href="#"> Vivo V Series</a></li>
                <li><a class="dropdown-item" href="#"> Vivo T Series </a></li>
                <li><a class="dropdown-item" href="#"> Vivo Y Series </a></li>
              </ul>
          </li>
          <li class="nav-item dropdown" style="padding-left: 50px;">
            <a class="nav-link dropdown-toggle text-white" href="#" data-bs-toggle="dropdown">  Nokia  </a>
              <ul class="dropdown-menu fade-up">
                <li><a class="dropdown-item" href="#"> Nokia</a></li>
                <li><a class="dropdown-item" href="#"> Nokia Plus </a></li>
              </ul>
          </li>
          <li class="nav-item dropdown" style="padding-left: 50px;">
            <a class="nav-link dropdown-toggle text-white" href="#" data-bs-toggle="dropdown">  Realme  </a>
              <ul class="dropdown-menu fade-up">
                <li><a class="dropdown-item" href="#"> Realme C</a></li>
                <li><a class="dropdown-item" href="#"> Realme Cs </a></li>
              </ul>
          </li>
        </ul>
      </div> 
     </nav>
  </div>

  <!-- display cart -->
  <div class=" container-fluid mt-3 d-flex justify-content-center row">
  	<div class="col-8" id="wrapper"  style="background-color:#ffffff;" >	
  	  <div class="row p-2" >
  	  	<h3> Có [[${orderNumber}]] sản phẩm trong giỏ hàng</h3>
  	  </div>	
      <div class="row p-2" th:each="order : ${productcarts.orders}" style="border-top: 2px solid #476e5d">
        <div class="col-5">
        	<div class="row">
        	 	<img id="phonePicture" th:src="@{${'/uploads/' + order.edition.telephone.pictureUrl}}" width="150" height="300" >
        	</div>	
        	<div class="row text-center">
        		<span style="font-size:20px;" class = "phoneName"><strong>[[*{order.edition.telephone.name}]] [[*{order.edition.capacity}]]GB</strong></span>
        	</div>	
        </div>
        
        <div class="col-3">
        	<div class="row d-flex justify-content-center " style="margin-top:110px;">
				<button style="width:40px; height:40px;" th:attr="onclick=|subAction('${order.id}')|" th:disabled="${order.quantity == 1}"><i class="fa fa-minus" aria-hidden="true"></i></button>	
				<input class="text-center quantityItemNumber" style="width:40px; height:40px; border:1px solid black; font-size:18px; font-weight:bold;" th:value="${order.quantity}" readonly/>
				<button type="button" style="width:40px; height:40px;" th:attr="onclick=|plusAction('${order.id}')|" ><i class="fa fa-plus" aria-hidden="true"></i></button>
        	</div>	
        	<div class="row mt-1 d-flex justify-content-center">
        		<button style="width:40px; height:40px;" th:attr="onclick=|deleteAction('${order.id}')|"><i style="font-size:20px;margin-left:-2px;" class="fa fa-trash-o" aria-hidden="true"></i> </button>
        	</div>	
        </div>
        
        <div class="col-4">
           	<div class="row d-flex justify-content-center" style="margin-top:110px;">
        		<span class="col-12 text-center originalPrice"   style="font-weight:bold; font-size: 20px; color:#cb1c22">[[${#numbers.formatDecimal((order.edition.price -order.edition.discount)*order.quantity, 0, 'COMMA', 0, 'POINT')}]] VND</span>
        	</div>
        	<div class="row d-flex justify-content-center" >
				<span class="col-12 text-center"   style="font-weight:bold; font-size: 14px; color:grey"> <del>  [[${#numbers.formatDecimal(order.edition.price*order.quantity, 0, 'COMMA', 0, 'POINT')}]] VND</del></span>
        	</div>	
        </div>
      </div>
      
	<!--total amount -->
	  <div class="row  p-2 d-flex justify-content-end" style="border-top: 2px solid #476e5d">
	  	  <div class="col-5  p-2" style="height:120px;font-family: 'Numans', sans-serif;">
	  	  	 <pre style="font-family: 'Numans', sans-serif;font-size: 16px;" id="oriPrice">Tổng tiền:                            [[${#numbers.formatDecimal(oriPrice, 0, 'COMMA', 0, 'POINT')}]] VND</pre>
	  	  	 <pre style="font-family: 'Numans', sans-serif;font-size: 16px;" id="sale">Khuyến mãi:                        -[[${#numbers.formatDecimal(sale, 0, 'COMMA', 0, 'POINT')}]] VND</pre>
	  	  	 <pre style="font-family: 'Numans', sans-serif;font-weight:bold;font-size: 18px; color:#cb1c22;" id="finalPrice"><span style="color:black;">Cần thanh toán:</span>           [[${#numbers.formatDecimal(finalPrice, 0, 'COMMA', 0, 'POINT')}]] VND</pre>
	  	  </div>		
  	  </div>
  	  
	<!--Order Form 	 -->
		<form class="row mt-2 p-2 needs-validation" method="post" th:action="@{/cart/mail/complete}" style="border-top: 2px solid #476e5d">
		  <div class="row  d-flex flex-row-reverse p-2">
		    <div class="col-4">
		      <input type="number" class="form-control" placeholder="Nhập số điện thoại" name="phoneNumber" required>
		      <input type="hidden" class="form-control"  id="phoneNameList" name="phoneNameList">
		      <input type="hidden" class="form-control"  id="oriPriceForm" name="oriPriceForm">
		      <input type="hidden" class="form-control"  id="saleForm" name="saleForm">
		      <input type="hidden" class="form-control"  id="finalPriceForm" name="finalPriceForm">
		    </div>
		    <div class="col-4">
		      <input type="text" class="form-control" placeholder="Nhập họ và tên" name="fullName" required>
		    </div>
		  </div>
		  <div class="row d-flex flex-row-reverse  p-2">
		  	<div class="col-8">
		      <input type="text" class="form-control" placeholder="Nhập email" name="email" required>
		    </div>
		  </div>
		  <div class="row d-flex flex-row-reverse  p-2">
		  	<div class="col-8">
		      <input type="submit" class="form-control btn btn-danger" value="Hoàn tất đặt hàng" required>
		    </div>
		  </div>
		</form>
      
	</div> 	
  </div>
      
      
  <div style="height:50px">
  </div>

</div>


<script>
  function phoneDetail(editionId){
		window.location.href = "/user/phoneDetail/" +editionId;
  }
  
  function plusAction(orderId){
	  window.location.href = "/cart/orders/plusAction/" +orderId; 
  }
  
  function subAction(orderId){
	  window.location.href = "/cart/orders/subAction/" +orderId; 
  }
  
  function deleteAction(orderId){
	  window.location.href = "/cart/orders/deleteAction/" +orderId; 
  }
  
  $(document).ready(function () {
    $('#logoQV').click(function(e){
    	window.location.href = "/loginSuccess";
    });
    
    $('#logoutAccount').click(function(){
    	window.location.href = "/logout" ;
    });
	
    $('#cart').click(function(){
    	window.location.href = "/cart/orders";
    });
    
    var numberArray = [];
    
    $('.quantityItemNumber').each(function(){
    	numberArray.push($(this).val());
    });
    
    var phoneNameList = "";
    var i = 0;
    $('.phoneName').each(function(){
    	phoneNameList += $(this).text() + " với số lượng :" + numberArray[i] +  " \n" ;
    	i++;
    });
    i = 0;
    
    $('#phoneNameList').val(phoneNameList);
    
    $('#oriPriceForm').val($('#oriPrice').text());
    $('#saleForm').val($('#sale').text());
    $('#finalPriceForm').val($('#finalPrice').text());
    
    $('#searchByNameBtn').click(function(){
    	window.location.href = "/user/findByName/" + $("#nameSearch").val();
    });
    
  })	
</script>
</body>
</html>